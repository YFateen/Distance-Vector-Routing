Last login: Mon Oct  1 13:45:11 on ttys001
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.008s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.011s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.011s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..FFFFFFFFFFFFFFFFFFFFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1698, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_no_update_poison (__main__.TestTriggeredIncrementalUpdates)
Down link, no advertise (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1821, in test_handle_link_down_no_update_poison
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)
	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_slightly_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (still not shortest) (w/ poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1612, in test_non_shortest_route_slightly_shorter_poison
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_poison_no_update (__main__.TestTriggeredIncrementalUpdates)
Don't advertise if poisoning doesn't change forwarding table.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1879, in test_poison_no_update
    route_latency=INFINITY)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

----------------------------------------------------------------------
Ran 29 tests in 0.064s

FAILED (failures=27)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  2 / 29 passed (27 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 70.69 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.010s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.010s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1696)test_consecutive()
-> with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
(Pdb) list
1691 	            self.router.handle_route_advertisement(h1, port=1, route_latency=3)
1692 	        self._assert_route_ads_sent(ads, {1: set(), 2: {Route(h1, 8)},
1693 	                                          3: {Route(h1, 8)}})
1694 	
1695 	        pdb.set_trace()
1696 ->	        with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
1697 	            self.router.handle_route_advertisement(h2, port=1, route_latency=6)
1698 	        self._assert_route_ads_sent(ads, {1: set(), 2: {Route(h2, 11)},
1699 	                                          3: {Route(h2, 11)}})
1700 	
1701 	        with self._ensure_no_send(all_ports={1, 2, 3}):
(Pdb) print self.router.forwarding_table
=== Forwarding Table ===
	ForwardingTableEntry(dst=h1, port=1, latency=8)
(Pdb) continue
FF..FFFFFFFFFFFFFFFFFFFFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1696, in test_consecutive
    with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_no_update_poison (__main__.TestTriggeredIncrementalUpdates)
Down link, no advertise (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1821, in test_handle_link_down_no_update_poison
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)
	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_slightly_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (still not shortest) (w/ poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1612, in test_non_shortest_route_slightly_shorter_poison
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_poison_no_update (__main__.TestTriggeredIncrementalUpdates)
Don't advertise if poisoning doesn't change forwarding table.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1879, in test_poison_no_update
    route_latency=INFINITY)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

----------------------------------------------------------------------
Ran 29 tests in 87.797s

FAILED (failures=27)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  2 / 29 passed (27 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 70.69 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
EEEEEEEEEEE
======================================================================
ERROR: test_inf_route_unreachable_existing_host (__main__.TestHandleAdvertisement)
Router treats >= INFINITY host (updated route) as unreachable.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1188, in test_inf_route_unreachable_existing_host
    route_latency=INFINITY)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_inf_route_unreachable_new_host (__main__.TestHandleAdvertisement)
Router treats new >= INFINITY host as unreachable.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1172, in test_inf_route_unreachable_new_host
    route_latency=INFINITY)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_new_destination (__main__.TestHandleAdvertisement)
Unique route for a new destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 971, in test_new_destination
    self.router.handle_route_advertisement(h3, port=2, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_new_route_non_shortest (__main__.TestHandleAdvertisement)
Route through new port for an existing destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1016, in test_new_route_non_shortest
    self.router.handle_route_advertisement(h2, port=2, route_latency=9)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_new_route_shortest (__main__.TestHandleAdvertisement)
Route through new port for an existing destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 994, in test_new_route_shortest
    self.router.handle_route_advertisement(h2, port=2, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_update_other_route_longer (__main__.TestHandleAdvertisement)
Update non-shortest route to a larger latency.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1082, in test_update_other_route_longer
    self.router.handle_route_advertisement(h2, port=1, route_latency=1)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_update_route_even_longer (__main__.TestHandleAdvertisement)
Update shortest route to larger latency; another route is picked.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1060, in test_update_route_even_longer
    self.router.handle_route_advertisement(h1, port=1, route_latency=9)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_update_route_longer (__main__.TestHandleAdvertisement)
Update shortest route to a larger latency.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1038, in test_update_route_longer
    self.router.handle_route_advertisement(h1, port=1, route_latency=7)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_update_route_non_shortest_even_shorter (__main__.TestHandleAdvertisement)
Update non-shortest route to become shortest route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1148, in test_update_route_non_shortest_even_shorter
    self.router.handle_route_advertisement(h1, port=3, route_latency=1)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_update_route_non_shortest_shorter (__main__.TestHandleAdvertisement)
Update non-shortest route to a smaller latency.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1126, in test_update_route_non_shortest_shorter
    self.router.handle_route_advertisement(h1, port=3, route_latency=9)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_update_route_shortest_shorter (__main__.TestHandleAdvertisement)
Update shortest route to a smaller latency.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1104, in test_update_route_shortest_shorter
    self.router.handle_route_advertisement(h1, port=1, route_latency=7)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

----------------------------------------------------------------------
Ran 11 tests in 0.013s

FAILED (errors=11)

********** Stage 6: TestRemoveRoutes **********
EEEEEEE
======================================================================
ERROR: test_expire_routes_forever (__main__.TestRemoveRoutes)
Routes with expire_time=FOREVER shouldn't expire.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_expire_routes_more (__main__.TestRemoveRoutes)
Expire all routes for a destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_expire_routes_none (__main__.TestRemoveRoutes)
No routes expire.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_expire_routes_some (__main__.TestRemoveRoutes)
Some of the routes for a destination expire.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_no_route (__main__.TestRemoveRoutes)
Take down links; no routes to a destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_no_routes (__main__.TestRemoveRoutes)
Take down a link that no route goes through.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_other_route (__main__.TestRemoveRoutes)
Take a link down, forcing another route to destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

----------------------------------------------------------------------
Ran 7 tests in 0.006s

FAILED (errors=7)

********** Stage 7: TestPoisonReverse **********
EEEEE
======================================================================
ERROR: test_handle_poison_alternate_route (__main__.TestPoisonReverse)
When a route is poisoned, use alternate route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_poison_no_route (__main__.TestPoisonReverse)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_poison_no_route_unpoison (__main__.TestPoisonReverse)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_poison_reverse (__main__.TestPoisonReverse)
Ensures that poison reverse advertisements are sent.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_poison_reverse_link_down (__main__.TestPoisonReverse)
Poison reverse when route changes due to link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

----------------------------------------------------------------------
Ran 5 tests in 0.005s

FAILED (errors=5)

********** Stage 8: TestTriggeredIncrementalUpdates **********
EEEEEEEEEEEEEEEEEEEEEEEEEEEEE
======================================================================
ERROR: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1691, in test_consecutive
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1722, in test_consecutive_poison
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_expire_no_duplicate (__main__.TestTriggeredIncrementalUpdates)
Ensures no duplicate advertisement in case of route timeout.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1826, in test_expire_no_duplicate
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_expire_no_duplicate_with_poison (__main__.TestTriggeredIncrementalUpdates)
Ensures no duplicate advertisement in case of route timeout (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1842, in test_expire_no_duplicate_with_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1812, in test_handle_link_down_no_update
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_no_update_poison (__main__.TestTriggeredIncrementalUpdates)
Down link, no advertise (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1819, in test_handle_link_down_no_update_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1749, in test_handle_link_down_update
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1789, in test_handle_link_down_update_multiple
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1800, in test_handle_link_down_update_multiple_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1760, in test_handle_link_down_update_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1657, in test_new_host
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1669, in test_new_host_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1460, in test_new_route
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1476, in test_new_route_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1500, in test_non_shortest_route_longer
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1506, in test_non_shortest_route_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1625, in test_non_shortest_route_shorter
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1637, in test_non_shortest_route_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1604, in test_non_shortest_route_slightly_shorter
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_non_shortest_route_slightly_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (still not shortest) (w/ poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1610, in test_non_shortest_route_slightly_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1858, in test_poison_alternate_route
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_poison_no_update (__main__.TestTriggeredIncrementalUpdates)
Don't advertise if poisoning doesn't change forwarding table.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1874, in test_poison_no_update
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1883, in test_propagate_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1573, in test_shortest_route_longer
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1587, in test_shortest_route_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1526, in test_shortest_route_shorter
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1532, in test_shortest_route_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1552, in test_shortest_route_slightly_longer
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

======================================================================
ERROR: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1558, in test_shortest_route_slightly_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 323, in _add_test_routes_proper
    self.router.handle_route_advertisement(h1, port=1, route_latency=3)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 167, in send_routes
    if (not POISON_MODE):
NameError: global name 'POISON_MODE' is not defined

----------------------------------------------------------------------
Ran 29 tests in 0.031s

FAILED (errors=29)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            :  0 / 11 passed (11 FAILED)
	Stage 6 TestRemoveRoutes                   :  0 / 7  passed (7 FAILED)
	Stage 7 TestPoisonReverse                  :  0 / 5  passed (5 FAILED)
	Stage 8 TestTriggeredIncrementalUpdates    :  0 / 29 passed (29 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 40.00 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.011s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.014s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFF.FFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1693, in test_consecutive
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h2, latency=5)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=2)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=4)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>, <RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=6)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.058s

FAILED (failures=23)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  6 / 29 passed (23 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 72.07 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1696)test_consecutive()
-> with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
(Pdb) continue
FF..F.FFFFFFFFF.FFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1696, in test_consecutive
    with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 11>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 1.847s

FAILED (failures=23)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  6 / 29 passed (23 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 72.07 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.010s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..FFFFFFFFFFFFFFFFFFFFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1693, in test_consecutive
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=16)
		Actual:   RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_no_update_poison (__main__.TestTriggeredIncrementalUpdates)
Down link, no advertise (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1821, in test_handle_link_down_no_update_poison
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>, <RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h2, latency=5)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h3, latency=16)
		Actual:   RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=16)
		Actual:   RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=16)
		Actual:   RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h3, latency=16)
		Actual:   RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=2)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=16)
		Actual:   RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=4)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=16)
		Actual:   RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>, <RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_non_shortest_route_slightly_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (still not shortest) (w/ poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1612, in test_non_shortest_route_slightly_shorter_poison
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=16)
		Actual:   RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_poison_no_update (__main__.TestTriggeredIncrementalUpdates)
Don't advertise if poisoning doesn't change forwarding table.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1879, in test_poison_no_update
    route_latency=INFINITY)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h2, latency=16)
		Actual:   RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=6)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=6)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

----------------------------------------------------------------------
Ran 29 tests in 0.067s

FAILED (failures=27)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  2 / 29 passed (27 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 70.69 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1696)test_consecutive()
-> with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
(Pdb) continue
FF..F.FFFFFFFFF.FFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1696, in test_consecutive
    with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 11>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 2.606s

FAILED (failures=23)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  6 / 29 passed (23 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 72.07 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1696)test_consecutive()
-> with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
(Pdb) continue
FF............FF......FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1696, in test_consecutive
    with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 1.871s

FAILED (failures=8)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 21 / 29 passed (8 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.24 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.011s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1696)test_consecutive()
-> with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
(Pdb) continue
FF............FF......FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1696, in test_consecutive
    with self._patch_send_routes(all_ports={1, 2, 3}) as ads:
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 2.417s

FAILED (failures=8)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 21 / 29 passed (8 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.24 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.008s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.012s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.010s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.010s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF............FF......FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>, <RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.050s

FAILED (failures=8)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 21 / 29 passed (8 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.24 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
.E.
======================================================================
ERROR: test_send_routes (__main__.TestAdvertise)
Ensures that send_routes(force=True) advertises correctly.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 921, in test_send_routes
    self.router.send_routes(force=True)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 159, in send_routes
    self.routes_advertised.update({port: tempPacket})
UnboundLocalError: local variable 'tempPacket' referenced before assignment

----------------------------------------------------------------------
Ran 3 tests in 0.004s

FAILED (errors=1)

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.010s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.011s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF............EF......FF..F.F
======================================================================
ERROR: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1493, in _test_non_shortest_route_longer
    self.router.send_routes(force=True)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 159, in send_routes
    self.routes_advertised.update({port: tempPacket})
UnboundLocalError: local variable 'tempPacket' referenced before assignment

======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.051s

FAILED (failures=7, errors=1)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  2 / 3  passed (1 FAILED)
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 21 / 29 passed (8 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 73.91 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.005s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.015s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.012s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.007s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.003s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.023s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.023s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.010s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.077s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.015s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.010s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.011s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.051s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.008s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.017s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.011s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFFFFFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 11>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.062s

FAILED (failures=24)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  5 / 29 passed (24 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 71.72 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.052s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.053s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.010s

OK

********** Stage 7: TestPoisonReverse **********
EEEEE
======================================================================
ERROR: test_handle_poison_alternate_route (__main__.TestPoisonReverse)
When a route is poisoned, use alternate route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_handle_poison_no_route (__main__.TestPoisonReverse)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_handle_poison_no_route_unpoison (__main__.TestPoisonReverse)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_poison_reverse (__main__.TestPoisonReverse)
Ensures that poison reverse advertisements are sent.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_poison_reverse_link_down (__main__.TestPoisonReverse)
Poison reverse when route changes due to link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

----------------------------------------------------------------------
Ran 5 tests in 0.006s

FAILED (errors=5)

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF.E.E..EE.E.E.E.E.EEEEFE.E.E
======================================================================
ERROR: test_expire_no_duplicate_with_poison (__main__.TestTriggeredIncrementalUpdates)
Ensures no duplicate advertisement in case of route timeout (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1842, in test_expire_no_duplicate_with_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_handle_link_down_no_update_poison (__main__.TestTriggeredIncrementalUpdates)
Down link, no advertise (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1819, in test_handle_link_down_no_update_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1800, in test_handle_link_down_update_multiple_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1760, in test_handle_link_down_update_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1669, in test_new_host_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1476, in test_new_route_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1506, in test_non_shortest_route_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1637, in test_non_shortest_route_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_non_shortest_route_slightly_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (still not shortest) (w/ poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1610, in test_non_shortest_route_slightly_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1858, in test_poison_alternate_route
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_poison_no_update (__main__.TestTriggeredIncrementalUpdates)
Don't advertise if poisoning doesn't change forwarding table.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1874, in test_poison_no_update
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1883, in test_propagate_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1587, in test_shortest_route_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1532, in test_shortest_route_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
ERROR: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1558, in test_shortest_route_slightly_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 329, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=3, route_latency=2)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 188, in send_routes
    or (not self.compare_packets(self.routes_advertised.get(ftEntry.port), tempPacket))):
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 229, in compare_packets
    if ((packetA.latency == packetB.latency) and (packetA.dst == packetB.dst)):
AttributeError: 'NoneType' object has no attribute 'latency'

======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=8)
		Actual:   RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=8)
		Actual:   RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

----------------------------------------------------------------------
Ran 29 tests in 0.046s

FAILED (failures=3, errors=15)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  0 / 5  passed (5 FAILED)
	Stage 8 TestTriggeredIncrementalUpdates    : 11 / 29 passed (18 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 63.79 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF...F..FF.F.F...F.FFFFFF.F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=8)
		Actual:   RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=8)
		Actual:   RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_handle_link_down_no_update_poison (__main__.TestTriggeredIncrementalUpdates)
Down link, no advertise (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1821, in test_handle_link_down_no_update_poison
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h3, latency=11)
		Actual:   RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisements:
	
		Expected: RouteAd(dst=h1, latency=13)
		Actual:   RouteAd(dst=h1, latency=16)
	
		Expected: RouteAd(dst=h3, latency=11)
		Actual:   RouteAd(dst=h3, latency=16)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=13)
		Actual:   RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h3, latency=2)
		Actual:   RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h3, latency=2)
		Actual:   RouteAd(dst=h3, latency=16)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=2)
		Actual:   RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=2)
		Actual:   RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=4)
		Actual:   RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (still not shortest) (w/ poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1612, in test_non_shortest_route_slightly_shorter_poison
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=13)
		Actual:   RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_poison_no_update (__main__.TestTriggeredIncrementalUpdates)
Don't advertise if poisoning doesn't change forwarding table.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1879, in test_poison_no_update
    route_latency=INFINITY)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>, <RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)
	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)
	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)
	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h2, latency=11)
		Actual:   RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h2, latency=11)
		Actual:   RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h2, latency=11)
		Actual:   RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=6)
		Actual:   RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=6)
		Actual:   RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h1, latency=6)
		Actual:   RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)
	
	INCORRECT route advertisement:
	
		Expected: RouteAd(dst=h2, latency=6)
		Actual:   RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.058s

FAILED (failures=16)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 13 / 29 passed (16 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 74.48 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.004s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.008s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.007s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.054s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.053s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.016s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFFFFFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1699, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.058s

FAILED (failures=24)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  5 / 29 passed (24 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 71.72 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.010s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFFFFFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1699, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.058s

FAILED (failures=24)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  5 / 29 passed (24 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 71.72 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.004s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFFFFFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1699, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.057s

FAILED (failures=24)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  5 / 29 passed (24 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 71.72 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.008s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.013s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.011s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.011s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFFFFFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1699, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.055s

FAILED (failures=24)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  5 / 29 passed (24 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 71.72 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFFFFFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1699, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.065s

FAILED (failures=24)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  5 / 29 passed (24 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 71.72 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.011s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.011s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF..F.FFFFFFFFFFFFF.F.FFFFFFF
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1699, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1724, in test_consecutive_poison
    3: {Route(h1, 8)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1814, in test_handle_link_down_no_update
    self.router.handle_link_down(port=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1754, in test_handle_link_down_update
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1794, in test_handle_link_down_update_multiple
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1806, in test_handle_link_down_update_multiple_poison
    10: {Route(h1, 13), Route(h3, 11)},
  File "dv_unit_tests.py", line 1785, in _test_handle_link_down_update_multiple
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=16)
		RouteAd(dst=h3, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisements:
		RouteAd(dst=h1, latency=13)
		RouteAd(dst=h3, latency=11)

======================================================================
FAIL: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1765, in test_handle_link_down_update_poison
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 1745, in _test_handle_link_down_update
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1663, in test_new_host
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1653, in _test_new_host
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h3, latency=2)

======================================================================
FAIL: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1470, in test_new_route
    10: {Route(h1, 2)}
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1487, in test_new_route_poison
    10: {Route(h1, 2)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=2)

======================================================================
FAIL: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1501, in test_non_shortest_route_longer
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1508, in test_non_shortest_route_longer_poison
    self._test_non_shortest_route_longer()
  File "dv_unit_tests.py", line 1496, in _test_non_shortest_route_longer
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1643, in test_non_shortest_route_shorter_poison
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1621, in _test_non_shortest_route_shorter
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=4)

======================================================================
FAIL: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1605, in test_non_shortest_route_slightly_shorter
    self._test_non_shortest_route_slightly_shorter()
  File "dv_unit_tests.py", line 1600, in _test_non_shortest_route_slightly_shorter
    self.router.handle_route_advertisement(h2, port=1, route_latency=5)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h2> at cost 5>]

======================================================================
FAIL: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1869, in test_poison_alternate_route
    10: {Route(h1, 13)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=13)

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisements:
		RouteAd(dst=h1, latency=8)
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1593, in test_shortest_route_longer_poison
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=16)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1527, in test_shortest_route_shorter
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=5)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 3:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h1, latency=6)

======================================================================
FAIL: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1553, in test_shortest_route_slightly_longer
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 10:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 2:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

MISMATCH detected for route advertisements sent to port 10:	
	MISSING route advertisement:
		RouteAd(dst=h2, latency=6)

----------------------------------------------------------------------
Ran 29 tests in 0.056s

FAILED (failures=24)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    :  5 / 29 passed (24 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 71.72 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.008s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.012s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.056s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.011s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
E.E.EEE
======================================================================
ERROR: test_expire_routes_forever (__main__.TestRemoveRoutes)
Routes with expire_time=FOREVER shouldn't expire.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_expire_routes_none (__main__.TestRemoveRoutes)
No routes expire.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_no_route (__main__.TestRemoveRoutes)
Take down links; no routes to a destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_no_routes (__main__.TestRemoveRoutes)
Take down a link that no route goes through.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_other_route (__main__.TestRemoveRoutes)
Take a link down, forcing another route to destination.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1210, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

----------------------------------------------------------------------
Ran 7 tests in 0.009s

FAILED (errors=5)

********** Stage 7: TestPoisonReverse **********
EEEEE
======================================================================
ERROR: test_handle_poison_alternate_route (__main__.TestPoisonReverse)
When a route is poisoned, use alternate route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_poison_no_route (__main__.TestPoisonReverse)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_poison_no_route_unpoison (__main__.TestPoisonReverse)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_poison_reverse (__main__.TestPoisonReverse)
Ensures that poison reverse advertisements are sent.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_poison_reverse_link_down (__main__.TestPoisonReverse)
Poison reverse when route changes due to link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1345, in setUp
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

----------------------------------------------------------------------
Ran 5 tests in 0.006s

FAILED (errors=5)

********** Stage 8: TestTriggeredIncrementalUpdates **********
FEEEEEEEEEEEEEEEEEEEEEEEEEEEE
======================================================================
ERROR: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1727, in test_consecutive_poison
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_expire_no_duplicate (__main__.TestTriggeredIncrementalUpdates)
Ensures no duplicate advertisement in case of route timeout.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1826, in test_expire_no_duplicate
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_expire_no_duplicate_with_poison (__main__.TestTriggeredIncrementalUpdates)
Ensures no duplicate advertisement in case of route timeout (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1842, in test_expire_no_duplicate_with_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_no_update (__main__.TestTriggeredIncrementalUpdates)
Shouldn't advertise when downed link affects no advertised route.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1812, in test_handle_link_down_no_update
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_no_update_poison (__main__.TestTriggeredIncrementalUpdates)
Down link, no advertise (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1821, in test_handle_link_down_no_update_poison
    self.router.handle_link_down(port=10)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 89, in handle_link_down
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_update (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1749, in test_handle_link_down_update
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_update_multiple (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1789, in test_handle_link_down_update_multiple
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_update_multiple_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise multiple updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1800, in test_handle_link_down_update_multiple_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_handle_link_down_update_poison (__main__.TestTriggeredIncrementalUpdates)
Advertise updated routes on link down (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1760, in test_handle_link_down_update_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_new_host (__main__.TestTriggeredIncrementalUpdates)
Route to new host.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1657, in test_new_host
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_new_host_poison (__main__.TestTriggeredIncrementalUpdates)
Route to new host (with poisoning).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1675, in test_new_host_poison
    10: {Route(h3, 2)},
  File "dv_unit_tests.py", line 1651, in _test_new_host
    self.router.handle_route_advertisement(h3, port=2, route_latency=1)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_new_route (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1464, in test_new_route
    self.router.handle_route_advertisement(h1, port=2, route_latency=1)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_new_route_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered update when new route is shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1481, in test_new_route_poison
    self.router.handle_route_advertisement(h1, port=2, route_latency=1)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_non_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1500, in test_non_shortest_route_longer
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_non_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
No triggered update advertisements should be sent if no updates.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1506, in test_non_shortest_route_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_non_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1631, in test_non_shortest_route_shorter
    10: {Route(h1, 4)},
  File "dv_unit_tests.py", line 1619, in _test_non_shortest_route_shorter
    self.router.handle_route_advertisement(h1, port=3, route_latency=1)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_non_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shortest (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1637, in test_non_shortest_route_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_non_shortest_route_slightly_shorter (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (but still not shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1604, in test_non_shortest_route_slightly_shorter
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_non_shortest_route_slightly_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make non-shortest route shorter (still not shortest) (w/ poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1610, in test_non_shortest_route_slightly_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_poison_alternate_route (__main__.TestTriggeredIncrementalUpdates)
Advertise alternate route chosen due to poisoning.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1858, in test_poison_alternate_route
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_poison_no_update (__main__.TestTriggeredIncrementalUpdates)
Don't advertise if poisoning doesn't change forwarding table.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1874, in test_poison_no_update
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1883, in test_propagate_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1573, in test_shortest_route_longer
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_shortest_route_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1587, in test_shortest_route_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_shortest_route_shorter (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1526, in test_shortest_route_shorter
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1532, in test_shortest_route_shorter_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_shortest_route_slightly_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route slightly longer (still shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1552, in test_shortest_route_slightly_longer
    self._set_up_routes(poison=False)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
ERROR: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1558, in test_shortest_route_slightly_longer_poison
    self._set_up_routes(poison=True)
  File "dv_unit_tests.py", line 1456, in _set_up_routes
    self._add_test_routes_proper()
  File "dv_unit_tests.py", line 325, in _add_test_routes_proper
    self.router.handle_route_advertisement(h2, port=1, route_latency=6)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 106, in handle_route_advertisement
    self.send_routes(force=False)
  File "/Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_router.py", line 180, in send_routes
    or (not self.compare_packets(tempPacket, self.routes_advertised.get(port)))):
UnboundLocalError: local variable 'port' referenced before assignment

======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1699, in test_consecutive
    3: {Route(h2, 11)}})
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 2:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=8)

----------------------------------------------------------------------
Ran 29 tests in 0.041s

FAILED (failures=1, errors=28)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  2 / 7  passed (5 FAILED)
	Stage 7 TestPoisonReverse                  :  0 / 5  passed (5 FAILED)
	Stage 8 TestTriggeredIncrementalUpdates    :  0 / 29 passed (29 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 52.86 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1703, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1733, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1897, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1581, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1569, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1559, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.053s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.011s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.006s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.017s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.010s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1560)test_shortest_route_slightly_longer_poison()
-> self._test_shortest_route_slightly_longer()
(Pdb) list
1555 	
1556 	    def test_shortest_route_slightly_longer_poison(self):
1557 	        """Make shortest route longer (still shortest) (with poison)."""
1558 	        self._set_up_routes(poison=True)
1559 	        pdb.set_trace()
1560 ->	        self._test_shortest_route_slightly_longer()
1561 	        self.assertTrue(self.router.POISON_MODE, "poison mode should be on")
1562 	
1563 	    def _test_shortest_route_longer(self, expected_advertisements):
1564 	        """Make shortest route longer (no longer shortest)."""
1565 	        h2 = self.h2
(Pdb) prinnt self.router.forwarding_table
*** SyntaxError: invalid syntax (<stdin>, line 1)
(Pdb) print self.router.forwarding_table
=== Forwarding Table ===
	ForwardingTableEntry(dst=h1, port=1, latency=8)
	ForwardingTableEntry(dst=h2, port=3, latency=5)
(Pdb) list
1566 	
1567 	        with self._patch_send_routes(all_ports={1, 2, 3, 10}) as ads:
1568 	            self.router.handle_route_advertisement(h2, port=3, route_latency=9)
1569 	
1570 	        self._assert_route_ads_sent(ads, expected_advertisements)
1571 	
1572 	    def test_shortest_route_longer(self):
1573 	        """Make shortest route longer (no longer shortest)."""
1574 	        self._set_up_routes(poison=False)
1575 	        h2 = self.h2
1576 	        self._test_shortest_route_longer(expected_advertisements={
(Pdb) next
AssertionError: Assertio...cy=16)',)
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1560)test_shortest_route_slightly_longer_poison()
-> self._test_shortest_route_slightly_longer()
(Pdb) step
--Return--
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1560)test_shortest_route_slightly_longer_poison()->None
-> self._test_shortest_route_slightly_longer()
(Pdb) list
1555 	
1556 	    def test_shortest_route_slightly_longer_poison(self):
1557 	        """Make shortest route longer (still shortest) (with poison)."""
1558 	        self._set_up_routes(poison=True)
1559 	        pdb.set_trace()
1560 ->	        self._test_shortest_route_slightly_longer()
1561 	        self.assertTrue(self.router.POISON_MODE, "poison mode should be on")
1562 	
1563 	    def _test_shortest_route_longer(self, expected_advertisements):
1564 	        """Make shortest route longer (no longer shortest)."""
1565 	        h2 = self.h2
(Pdb) step
AssertionError: Assertio...cy=16)',)
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/case.py(329)run()
-> testMethod()
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/case.py(330)run()
-> except KeyboardInterrupt:
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/case.py(332)run()
-> except self.failureException:
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/case.py(333)run()
-> result.addFailure(self, sys.exc_info())
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/runner.py(73)addFailure()
-> def addFailure(self, test, err):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/runner.py(74)addFailure()
-> super(TextTestResult, self).addFailure(test, err)
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(15)inner()
-> @wraps(method)
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(17)inner()
-> if getattr(self, 'failfast', False):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(19)inner()
-> return method(self, *args, **kw)
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(119)addFailure()
-> @failfast
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(123)addFailure()
-> self.failures.append((test, self._exc_info_to_string(err, test)))
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(152)_exc_info_to_string()
-> def _exc_info_to_string(self, err, test):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(154)_exc_info_to_string()
-> exctype, value, tb = err
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(156)_exc_info_to_string()
-> while tb and self._is_relevant_tb_level(tb):
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(180)_is_relevant_tb_level()
-> def _is_relevant_tb_level(self, tb):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
--Return--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()->True
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(157)_exc_info_to_string()
-> tb = tb.tb_next
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(156)_exc_info_to_string()
-> while tb and self._is_relevant_tb_level(tb):
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(180)_is_relevant_tb_level()
-> def _is_relevant_tb_level(self, tb):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
--Return--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()->False
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(159)_exc_info_to_string()
-> if exctype is test.failureException:
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(161)_exc_info_to_string()
-> length = self._count_relevant_tb_levels(tb)
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(183)_count_relevant_tb_levels()
-> def _count_relevant_tb_levels(self, tb):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(184)_count_relevant_tb_levels()
-> length = 0
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(185)_count_relevant_tb_levels()
-> while tb and not self._is_relevant_tb_level(tb):
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(180)_is_relevant_tb_level()
-> def _is_relevant_tb_level(self, tb):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
--Return--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()->False
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(186)_count_relevant_tb_levels()
-> length += 1
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(187)_count_relevant_tb_levels()
-> tb = tb.tb_next
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(185)_count_relevant_tb_levels()
-> while tb and not self._is_relevant_tb_level(tb):
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(180)_is_relevant_tb_level()
-> def _is_relevant_tb_level(self, tb):
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
--Return--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(181)_is_relevant_tb_level()->False
-> return '__unittest' in tb.tb_frame.f_globals
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(186)_count_relevant_tb_levels()
-> length += 1
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(187)_count_relevant_tb_levels()
-> tb = tb.tb_next
(Pdb) 
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(185)_count_relevant_tb_levels()
-> while tb and not self._is_relevant_tb_level(tb):
(Pdb) 
--Call--
> /usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/unittest/result.py(180)_is_relevant_tb_level()
-> def _is_relevant_tb_level(self, tb):
(Pdb) continue
F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1704, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1734, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1898, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1582, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1570, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1560, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 37.826s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.008s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.011s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.011s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1560)test_shortest_route_slightly_longer_poison()
-> self._test_shortest_route_slightly_longer()
(Pdb) list
1555 	
1556 	    def test_shortest_route_slightly_longer_poison(self):
1557 	        """Make shortest route longer (still shortest) (with poison)."""
1558 	        self._set_up_routes(poison=True)
1559 	        pdb.set_trace()
1560 ->	        self._test_shortest_route_slightly_longer()
1561 	        self.assertTrue(self.router.POISON_MODE, "poison mode should be on")
1562 	
1563 	    def _test_shortest_route_longer(self, expected_advertisements):
1564 	        """Make shortest route longer (no longer shortest)."""
1565 	        h2 = self.h2
(Pdb) step
--Call--
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1538)_test_shortest_route_slightly_longer()
-> def _test_shortest_route_slightly_longer(self):
(Pdb) next
> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1539)_test_shortest_route_slightly_longer()
-> h2 = self.h2
(Pdb) print self.h2
<HostEntity h2>
(Pdb) print self.router.link_latency.get(3)
3
(Pdb) print self.router.forwarding_table
=== Forwarding Table ===
	ForwardingTableEntry(dst=h1, port=1, latency=8)
	ForwardingTableEntry(dst=h2, port=3, latency=5)
(Pdb) print self.router.forwarding_table
=== Forwarding Table ===
	ForwardingTableEntry(dst=h1, port=1, latency=8)
	ForwardingTableEntry(dst=h2, port=3, latency=5)
(Pdb) CONTINUE
*** NameError: name 'CONTINUE' is not defined
(Pdb) continue
F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1704, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1734, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1898, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1582, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1570, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1560, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1539, in _test_shortest_route_slightly_longer
    h2 = self.h2
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 258.107s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.001s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.> /Users/YFateen/BerkeleySemesters/Fall_2018/168/cs168-fall18-student/proj1_routing/simulator/dv_unit_tests.py(1560)test_shortest_route_slightly_longer_poison()
-> self._test_shortest_route_slightly_longer()
(Pdb) continue
F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1704, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1734, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1898, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1582, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1570, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1560, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 1.925s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.005s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.014s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.012s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1704, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1734, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1898, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1582, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1570, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1560, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.053s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ python dv_unit_tests.py 8
********** Stage 0: TestStarterCode **********
..
----------------------------------------------------------------------
Ran 2 tests in 0.003s

OK

********** Stage 1: TestUpdateForwardingTable **********
.........
----------------------------------------------------------------------
Ran 9 tests in 0.009s

OK

********** Stage 2: TestForwarding **********
....
----------------------------------------------------------------------
Ran 4 tests in 0.006s

OK

********** Stage 3: TestAdvertise **********
...
----------------------------------------------------------------------
Ran 3 tests in 0.004s

OK

********** Stage 4: TestStaticRoutes **********
.
----------------------------------------------------------------------
Ran 1 test in 0.002s

OK

********** Stage 5: TestHandleAdvertisement **********
...........
----------------------------------------------------------------------
Ran 11 tests in 0.015s

OK

********** Stage 6: TestRemoveRoutes **********
.......
----------------------------------------------------------------------
Ran 7 tests in 0.013s

OK

********** Stage 7: TestPoisonReverse **********
.....
----------------------------------------------------------------------
Ran 5 tests in 0.009s

OK

********** Stage 8: TestTriggeredIncrementalUpdates **********
FF....................FF..F.F
======================================================================
FAIL: test_consecutive (__main__.TestTriggeredIncrementalUpdates)
Tests triggered updates with consecutive route advertisements.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1704, in test_consecutive
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 2: [<RoutePacket to <HostEntity h1> at cost 8>]

======================================================================
FAIL: test_consecutive_poison (__main__.TestTriggeredIncrementalUpdates)
Triggered updates, consecutive route ads (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1734, in test_consecutive_poison
    route_latency=10)
  File "/usr/local/Cellar/python/2.7.14/Frameworks/Python.framework/Versions/2.7/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "dv_unit_tests.py", line 147, in _ensure_no_send
    port, packets
AssertionError: unexpected packet(s) sent to port 1: [<RoutePacket to <HostEntity h1> at cost 16>]

======================================================================
FAIL: test_propagate_poison (__main__.TestTriggeredIncrementalUpdates)
Propagate a poisoned forwarding entry.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1898, in test_propagate_poison
    10: {Route(h2, INFINITY)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

======================================================================
FAIL: test_shortest_route_longer (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (no longer shortest).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1582, in test_shortest_route_longer
    10: {Route(h2, 11)},
  File "dv_unit_tests.py", line 1570, in _test_shortest_route_longer
    self._assert_route_ads_sent(ads, expected_advertisements)
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=11)

======================================================================
FAIL: test_shortest_route_shorter_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route shorter (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1535, in test_shortest_route_shorter_poison
    self._test_shortest_route_shorter()
  File "dv_unit_tests.py", line 1521, in _test_shortest_route_shorter
    10: {Route(h1, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 1:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h1, latency=16)

======================================================================
FAIL: test_shortest_route_slightly_longer_poison (__main__.TestTriggeredIncrementalUpdates)
Make shortest route longer (still shortest) (with poison).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "dv_unit_tests.py", line 1560, in test_shortest_route_slightly_longer_poison
    self._test_shortest_route_slightly_longer()
  File "dv_unit_tests.py", line 1547, in _test_shortest_route_slightly_longer
    10: {Route(h2, 6)},
  File "dv_unit_tests.py", line 517, in _assert_route_ads_sent
    self.fail(message)
AssertionError: 

MISMATCH detected for route advertisements sent to port 3:	
	EXTRANEOUS route advertisement:
		RouteAd(dst=h2, latency=16)

----------------------------------------------------------------------
Ran 29 tests in 0.055s

FAILED (failures=6)

Overall scores:
	Stage 1 TestUpdateForwardingTable          :  9 / 9  passed
	Stage 2 TestForwarding                     :  4 / 4  passed
	Stage 3 TestAdvertise                      :  3 / 3  passed
	Stage 4 TestStaticRoutes                   :  1 / 1  passed
	Stage 5 TestHandleAdvertisement            : 11 / 11 passed
	Stage 6 TestRemoveRoutes                   :  7 / 7  passed
	Stage 7 TestPoisonReverse                  :  5 / 5  passed
	Stage 8 TestTriggeredIncrementalUpdates    : 23 / 29 passed (6 FAILED)
	Stage 9 TestRoutePoisoning                 :  tests not run

Total score: 77.93 / 90.00
airbears2-10-142-105-249:simulator YFateen$ 
